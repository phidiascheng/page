<html>
  <head>
    <meta charset="utf-8" />
    <script src="js/pdf-lib.min.js"></script>
    <script src="js/fontkit.umd.min.js"></script>
  </head>

  <body style="display: flex; justify-content: center;">
    <div style="display: block; text-align: center; width: 50%;">
      <div>
        <label for="text-input">输入汉字 <br> 例如: 弯弯的月儿小小的船，`小小的船儿两头尖。`我在小小的船里坐 <br> 半角 `(1左边那个)作为每一行的分隔，标点和空格也算一个字符<br>下面可以填入汉字的表格都可以在这里输入</label><br><br>
        <input style="width:100%;" id="text-input" type="text" placeholder="汉字:">
      </div><br>
      <div>
        <label for="text-input">输入拼音或英文 <br> 例如: 拼音 wan, wan, de, yue, er` Xiao, Xiao, de, chuan<br>
        半角`作为句子分隔，半角逗号作为拼音分隔，支持带音调的字符，可以任意空格，空格会被忽略掉<br>
        或输入英文: today is a nice day. ` we are going to play.<br>
        英文句子首尾的空格会被去掉，但中间的会保留。英文格里识别英文格式，其他识别拼音格式</label><br><br>
        <input style="width:100%;" id="text-pinyin" type="text" placeholder="拼音:">
      </div><br>
      <div>
        <button style="font-size: 20px;" id="createPDFFile" onclick="createTianzige()">生成田字格</button>
        <button style="font-size: 20px;" id="createPDFFile" onclick="createYingyuge()">生成英语格</button>
        <button style="font-size: 20px;" id="createPDFFile" onclick="createPinyinge()">生成拼音格</button>
        <button style="font-size: 20px;" id="createPDFFile" onclick="createZuowenge()">生成作文格</button>
        <button style="font-size: 20px;" id="createPDFFile" onclick="createCalcpaper()">生成加减草稿纸</button>
        <button style="font-size: 20px;" id="createPDFFile" onclick="createDivpaper()">生成除法草稿纸</button>
      </div>
      <div><iframe id="pdf" style="width:100%; height: 70%; display: none;"></iframe></div>
    </div>
  </body>




  <script>
    const { PDFDocument, StandardFonts, rgb } = PDFLib
    const thickness = 0.2;
//    const color = rgb(1, 0.753, 0.796);
    const color = rgb(0, 0, 0);
    const dashArray = [1, 0.5];
    const opacity = 0.75;

    async function createDivpaper() {
      const pdfDoc = await PDFLib.PDFDocument.create();
      const page = pdfDoc.addPage([297, 210]);
      const startx = 10;
      const starty = 10;
 

      for (let i=0;i<8;i++){
        for (let j=0; j<4; j++){
          page.drawLine({start: { x: startx+35.875*i, y: starty + 50.3*j +26 },end: { x: startx+35.875*i, y: starty + 50.3*j +6 +26},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+6, y: starty + 50.3*j +26 },end: { x: startx+35.875*i+6, y: starty + 50.3*j +6 +26},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i, y: starty + 50.3*j +26 },end: { x: startx+35.875*i+6, y: starty + 50.3*j +26},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i, y: starty + 50.3*j +6+26},end: { x: startx+35.875*i+6, y: starty + 50.3*j+6 +26},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});

          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j },end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*1},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*1},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*1 +0.5},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*1+0.5},thickness: thickness,color:color, opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*1 +1},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*1 +1},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*2 +1},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*2 +1},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*3 +1},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*3 +1},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*3 +1.5},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*3+1.5},thickness: thickness,color:color, opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*3 +2},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*3 +2},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*4 +2},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*4 +2},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*5 +2},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*5 +2},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});

          page.drawLine({start: { x: startx+35.875*i+8 -0.5, y: starty + 50.3*j +6*5 +2.5},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*5+2.5},thickness: thickness,color:color, opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8 -0.5, y: starty + 50.3*j +6*5 +2.5},end: { x: startx+35.875*i+8 -0.5 -1.8, y: starty + 50.3*j +6*5 +2.5 -8},thickness: thickness,color:color, opacity: opacity,});

          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*5 +3},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*5 +3},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+35.875*i+8, y: starty + 50.3*j +6*6 +3},end: { x: startx+35.875*i+8+6*3, y: starty + 50.3*j+6*6 +3},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});

          for (let k=0; k<4; k++){
            page.drawLine({start: { x: startx+35.875*i+8 +k*6, y: starty + 50.3*j},end: { x: startx+35.875*i+8 +k*6, y: starty + 50.3*j+6},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
            page.drawLine({start: { x: startx+35.875*i+8 +k*6, y: starty + 50.3*j +6 +1},end: { x: startx+35.875*i+8 +k*6, y: starty + 50.3*j+6*3 +1},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
            page.drawLine({start: { x: startx+35.875*i+8 +k*6, y: starty + 50.3*j +6*3 +2},end: { x: startx+35.875*i+8 +k*6, y: starty + 50.3*j+6*5+2},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
            page.drawLine({start: { x: startx+35.875*i+8 +k*6, y: starty + 50.3*j +6*5 +3},end: { x: startx+35.875*i+8 +k*6, y: starty + 50.3*j+6*6+3},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          }
        }
      }
      const pdfDataUri = await pdfDoc.saveAsBase64({ dataUri: true });
      document.getElementById('pdf').src = pdfDataUri;
      document.getElementById('pdf').style.display = "";
    }


    async function createCalcpaper() {
      const pdfDoc = await PDFLib.PDFDocument.create();
      const page = pdfDoc.addPage([297, 210]);
      const startx = 10;
      const starty = 10;
 

      for (let i=0;i<8;i++){
        for (let j=0; j<5; j++){
          page.drawLine({start: { x: startx+36*i, y: starty + 39.25*j },end: { x: startx+36*i+24, y: starty + 39.25*j},thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+36*i, y: starty + 39.25*j +6.2 },end: { x: startx+36*i+24, y: starty+ 39.25*j+ 6.2 },thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+36*i, y: starty + 39.25*j +6.7 },end: { x: startx+36*i+24, y: starty+ 39.25*j+ 6.7 },thickness: thickness,color:color, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i, y: starty + 39.25*j +7.2 },end: { x: startx+36*i+24, y: starty+ 39.25*j+ 7.2 },thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+36*i, y: starty + 39.25*j +7.2 +6.2 },end: { x: startx+36*i+24, y: starty+ 39.25*j+ 7.2 + 6.2 },thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+36*i, y: starty + 39.25*j +7.2 +6.2*2 },end: { x: startx+36*i+24, y: starty+ 39.25*j + 7.2 + 6.2*2 },thickness: thickness,color:color, dashArray: dashArray,opacity: opacity,});
          page.drawLine({start: { x: startx+36*i, y: starty + 39.25*j + 19.6 +0.5 },end: { x: startx+36*i+24, y: starty+ 39.25*j + 19.6 +0.5 },thickness: thickness,color:color, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6, y: starty + 39.25*j + 20.6 },end: { x: startx+36*i+24 , y: starty+ 39.25*j + 20.6 },thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6, y: starty + 39.25*j + 20.6 +6.2},end: { x: startx+36*i+24 , y: starty+ 39.25*j + 20.6 +6.2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6, y: starty + 39.25*j + 20.6 +12.4},end: { x: startx+36*i+24 , y: starty+ 39.25*j + 20.6 +12.4},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});

          page.drawLine({start: { x: startx+36*i , y: starty + 39.25*j },end: { x: startx+36*i, y: starty+ 39.25*j + 6.2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i , y: starty + 39.25*j +7.2 },end: { x: startx+36*i, y: starty+ 39.25*j +7.2 + 6.2*2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});

          page.drawLine({start: { x: startx+36*i +6, y: starty + 39.25*j },end: { x: startx+36*i+6, y: starty+ 39.25*j + 6.2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6, y: starty + 39.25*j +7.2 },end: { x: startx+36*i+6, y: starty+ 39.25*j +7.2 + 6.2*2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6, y: starty + 39.25*j +8.2 +6.2*2},end: { x: startx+36*i+6, y: starty+ 39.25*j +8.2 + 6.2*4},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});

          page.drawLine({start: { x: startx+36*i +6*2, y: starty + 39.25*j },end: { x: startx+36*i+6*2, y: starty+ 39.25*j + 6.2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6*2, y: starty + 39.25*j +7.2 },end: { x: startx+36*i+6*2, y: starty+ 39.25*j +7.2 + 6.2*2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6*2, y: starty + 39.25*j +8.2 +6.2*2},end: { x: startx+36*i+6*2, y: starty+ 39.25*j +8.2 + 6.2*4},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});

          page.drawLine({start: { x: startx+36*i +6*3, y: starty + 39.25*j },end: { x: startx+36*i+6*3, y: starty+ 39.25*j + 6.2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6*3, y: starty + 39.25*j +7.2 },end: { x: startx+36*i+6*3, y: starty+ 39.25*j +7.2 + 6.2*2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6*3, y: starty + 39.25*j +8.2 +6.2*2},end: { x: startx+36*i+6*3, y: starty+ 39.25*j +8.2 + 6.2*4},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});

          page.drawLine({start: { x: startx+36*i +6*4, y: starty + 39.25*j },end: { x: startx+36*i+6*4, y: starty+ 39.25*j + 6.2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6*4, y: starty + 39.25*j +7.2 },end: { x: startx+36*i+6*4, y: starty+ 39.25*j +7.2 + 6.2*2},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
          page.drawLine({start: { x: startx+36*i +6*4, y: starty + 39.25*j +8.2 +6.2*2},end: { x: startx+36*i+6*4, y: starty+ 39.25*j +8.2 + 6.2*4},thickness: thickness,color:color, dashArray: dashArray, opacity: opacity,});
        }
      }

      
      const pdfDataUri = await pdfDoc.saveAsBase64({ dataUri: true });
      document.getElementById('pdf').src = pdfDataUri;
      document.getElementById('pdf').style.display = "";
    }


    async function createZuowenge() {
      const pdfDoc = await PDFLib.PDFDocument.create();
      const page = pdfDoc.addPage([210, 297]);
      const startx = 10;
      const dx = 6.13;
      const starty = 16;
 
      page.drawLine({start: { x: startx, y: starty },end: { x: startx, y: starty+8.5*31-1.5 },thickness: thickness,color: color,opacity: opacity,});
      page.drawLine({start: { x: startx+dx*31, y: starty },end: { x: startx+dx*31, y: starty+8.5*31-1.5 },thickness: thickness,color: color,opacity: opacity,});

      for (let i=0;i<31;i++)
      {
        page.drawLine({start: { x: startx, y: starty + (8.5)*i },end: { x: startx+dx*31, y: starty+(8.5)*i },thickness: thickness,color: color,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + (8.5)*i+7 },end: { x: startx+dx*31, y: starty+(8.5)*i+7 },thickness: thickness,color: color,opacity: opacity,});
      }
      for (let i=0;i<31;i++){
        for (let j=0;j<31;j++){
          page.drawLine({start: { x: startx+(i+1)*dx, y: starty + 8.5*j },end: { x: startx+(i+1)*dx, y: starty+8.5*j+7 },thickness: thickness,color: color,opacity: opacity,});
        }
      }

      pdfDoc.registerFontkit(fontkit);
      var urlKai = "assets/华文楷体.ttf";
      var fontBytesKai = await fetch(urlKai).then((res) => res.arrayBuffer());
      const fontKai = await pdfDoc.embedFont(fontBytesKai);

      let inputh =document.getElementById('text-input').value;
      let Hanzi = inputh.split("`");

      for (let j=0;j<Hanzi.length;j++){
        for(let i=0;i<Hanzi[j].length;i++){
          page.moveTo(startx+i*dx, starty+(30-j)*8.5+1.5);
          page.drawText(Hanzi[j][i],{size: 6,font:fontKai});
        }
      }

      const pdfDataUri = await pdfDoc.saveAsBase64({ dataUri: true });
      document.getElementById('pdf').src = pdfDataUri;
      document.getElementById('pdf').style.display = "";
    }


    async function createTianzige() {
      const pdfDoc = await PDFLib.PDFDocument.create();
      const page = pdfDoc.addPage([297, 210]);
      const startx = 10;
      const starty = 25;

      page.drawLine({start: { x: startx, y: starty },end: { x: startx, y: starty+20*8 },thickness: thickness,color: color,opacity: opacity,});
      page.drawLine({start: { x: startx+23*12, y: starty },end: { x: startx+23*12, y: starty+20*8 },thickness: thickness,color: color,opacity: opacity,});

      for (let i=0;i<8;i++)
      {
        page.drawLine({start: { x: startx, y: starty + 20*i },end: { x: startx+23*12, y: starty+20*i },thickness: thickness,color: color,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 20*i+6 },end: { x: startx+23*12, y: starty+20*i+6 },thickness: thickness,color: color,dashArray: dashArray,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 20*i+12 },end: { x: startx+23*12, y: starty+20*i+12 },thickness: thickness,color: color,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 20*i+12+2.6 },end: { x: startx+23*12, y: starty+20*i+12+2.6 },thickness: thickness,color: color,dashArray: dashArray,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 20*i+12+2.6+2.8 },end: { x: startx+23*12, y: starty+20*i+12+2.6+2.8 },thickness: thickness,color: color,dashArray: dashArray,opacity: opacity,});
      }
      page.drawLine({start: { x: startx, y: starty + 20*8 },end: { x: startx+23*12, y: starty+20*8 },thickness: thickness,color: color,opacity: opacity,});
      for (let i=0;i<23;i++){
        for (let j=0;j<8;j++){
          page.drawLine({start: { x: startx+i*12+6, y: starty + 20*j },end: { x: startx+i*12+6, y: starty+20*j+12 },thickness: thickness,color: color,dashArray: dashArray,opacity: opacity,});
        }
      }
      for (let i=0;i<22;i++){
        for (let j=0;j<8;j++){
          page.drawLine({start: { x: startx+i*12+12, y: starty + 20*j },end: { x: startx+i*12+12, y: starty+20*j+12 },thickness: thickness,color: color,opacity: opacity,});
        }
      }

      pdfDoc.registerFontkit(fontkit);
      var urlKai = "assets/华文楷体.ttf";
      var fontBytesKai = await fetch(urlKai).then((res) => res.arrayBuffer());
      const fontKai = await pdfDoc.embedFont(fontBytesKai);
      var urlPin = "assets/印氪先生汉语拼音人教版W3-Light.ttf";
      var fontBytesPin = await fetch(urlPin).then((res) => res.arrayBuffer());
      const fontPin = await pdfDoc.embedFont(fontBytesPin);

      let inputh =document.getElementById('text-input').value;
      let Hanzi = inputh.split("`");
      let inputp =document.getElementById('text-pinyin').value;
      let iPinyin = inputp.replace(/\s/g,'').split("`");
      let Pinyin = [];

      for (let i=0; i<iPinyin.length;i++){
        let str = iPinyin[i].split(",");
        Pinyin.push(str);
      }

      for (let j=0;j<Hanzi.length;j++){
        for(let i=0;i<Hanzi[j].length;i++){
          page.moveTo(startx+i*12, starty+(7-j)*20+2);
          page.drawText(Hanzi[j][i],{size: 12,font:fontKai});
        }
      }
      for (let j=0;j<Pinyin.length;j++){
        for(let i=0;i<Pinyin[j].length;i++){
          var textWidth = fontPin.widthOfTextAtSize(Pinyin[j][i], 5.6);
          page.moveTo(startx+i*12+6-textWidth/2, starty+(7-j)*20+15);
          page.drawText(Pinyin[j][i],{size: 5.6,font:fontPin});
        }
      }

      const pdfDataUri = await pdfDoc.saveAsBase64({ dataUri: true });
      document.getElementById('pdf').src = pdfDataUri;
      document.getElementById('pdf').style.display = "";
    }

    async function createYingyuge() {
      const pdfDoc = await PDFLib.PDFDocument.create();
      const page = pdfDoc.addPage([297, 210]);
      const startx = 10;
      const endx = 287;
      const starty = 14.5;
      const endy = 210-14.5;

      page.drawLine({start: { x: startx, y: starty },end: { x: startx, y: endy },thickness: thickness,color: color,opacity: opacity,});
      page.drawLine({start: { x: endx, y: starty },end: { x: endx, y: endy },thickness: thickness,color: color,opacity: opacity,});

      for (let i=0;i<11;i++)
      {
        page.drawLine({start: { x: startx, y: starty + 17*i },end: { x: endx, y: starty+17*i },thickness: thickness,color: color,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 17*i+3.5 },end: { x: endx, y: starty+17*i+3.5 },thickness: thickness,color: color,dashArray: dashArray,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 17*i+7.5 },end: { x: endx, y: starty+17*i+7.5 },thickness: thickness,color: color,dashArray: dashArray,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 17*i+11 },end: { x: endx, y: starty+17*i+11 },thickness: thickness,color: color,opacity: opacity,});
      }

      pdfDoc.registerFontkit(fontkit);
      var urlPin = "assets/印氪先生汉语拼音人教版W3-Light.ttf";
      var fontBytesPin = await fetch(urlPin).then((res) => res.arrayBuffer());
      const fontPin = await pdfDoc.embedFont(fontBytesPin);

      let inputp =document.getElementById('text-pinyin').value;
      let iPinyin = inputp.split("`");
      let Pinyin = [];

      for (let i=0; i<iPinyin.length;i++){
        let str = iPinyin[i].trim();
        Pinyin.push(str);
      }

      for(let i=0;i<Pinyin.length;i++){
        page.moveTo(startx+1, starty+(11-i)*17-13);
        page.drawText(Pinyin[i],{size: 8,font:fontPin});
      }
 
      const pdfDataUri = await pdfDoc.saveAsBase64({ dataUri: true });
      document.getElementById('pdf').src = pdfDataUri;
      document.getElementById('pdf').style.display = "";
    }

    async function createPinyinge() {
      const pdfDoc = await PDFLib.PDFDocument.create();
      const page = pdfDoc.addPage([297, 210]);
      const startx = 10;
      const endx = 287;
      const nodes = 10;
      const starty = 14.5;
      const endy = 210-14.5;

      page.drawLine({start: { x: startx, y: starty },end: { x: startx, y: endy },thickness: thickness,color: color,opacity: opacity,});
      page.drawLine({start: { x: endx, y: starty },end: { x: endx, y: endy },thickness: thickness,color: color,opacity: opacity,});

      for (let i=0;i<11;i++)
      {
        page.drawLine({start: { x: startx, y: starty + 17*i },end: { x: endx, y: starty+17*i },thickness: thickness,color: color,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 17*i+3.5 },end: { x: endx, y: starty+17*i+3.5 },thickness: thickness,color: color,dashArray: dashArray,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 17*i+7.5 },end: { x: endx, y: starty+17*i+7.5 },thickness: thickness,color: color,dashArray: dashArray,opacity: opacity,});
        page.drawLine({start: { x: startx, y: starty + 17*i+11 },end: { x: endx, y: starty+17*i+11 },thickness: thickness,color: color,opacity: opacity,});
      }

      for (let i=0;i<nodes;i++)
      {
        for (let j=0;j<11;j++)
        {
          page.drawLine({start: { x: startx+277/nodes*i, y: starty + 17*j },end: { x: startx+277/nodes*i, y: starty+17*j+11 },thickness: thickness,color: color,opacity: opacity,});
        }
      }

      pdfDoc.registerFontkit(fontkit);
      var urlPin = "assets/印氪先生汉语拼音人教版W3-Light.ttf";
      var fontBytesPin = await fetch(urlPin).then((res) => res.arrayBuffer());
      const fontPin = await pdfDoc.embedFont(fontBytesPin);

      let inputp =document.getElementById('text-pinyin').value;
      let iPinyin = inputp.replace(/\s/g,'').split("`");
      let Pinyin = [];

      for (let i=0; i<iPinyin.length;i++){
        let str = iPinyin[i].split(",");
        Pinyin.push(str);
      }

      for(let i=0; i<Pinyin.length;i++){
        for(let j=0; j<Pinyin[i].length; j++){
          var textWidth = fontPin.widthOfTextAtSize(Pinyin[i][j], 8);
          page.moveTo(startx + 277/nodes/2 + j* 277/nodes - textWidth/2, starty+(11-i)*17-13);
          page.drawText(Pinyin[i][j],{size: 8,font:fontPin});
        }
      }
 
      const pdfDataUri = await pdfDoc.saveAsBase64({ dataUri: true });
      document.getElementById('pdf').src = pdfDataUri;
      document.getElementById('pdf').style.display = "";
    }
</script>
</html>